{% extends 'tupie_app/base.html' %}
{% load static %}
{% block title %}Requests Dashboard{% endblock %}

{% block content %}
<section class="requests-dashboard">
  <div class="container">
    <h1>Requests for Your Items</h1>

    {% if my_requests %}
      <div class="items-grid">
        {% for req in my_requests %}
          <div class="item-card">
            <h3>{{ req.item.title }}</h3>
            <p>
              <strong>From:</strong> {{ req.requester.username }}
              {% include 'tupie_app/_verification_badge.html' with user_profile=req.requester.userprofile %}
            </p>
            <p>
              <strong>Message:</strong>
              {% if req.message %}{{ req.message }}{% else %}<em>No message</em>{% endif %}
            </p>
            <p><strong>Status:</strong> 
              {% if req.status == "pending" %}
                <span style="color:orange;">Pending</span>
              {% elif req.status == "accepted" %}
                <span style="color:green;">Accepted  </span>
              {% else %}
                <span style="color:red;">Declined ❌</span>
              {% endif %}
            </p>
            
            {% if req.status == "pending" %}
              <div class="actions">
                <a href="{% url 'update_request_status' req.id 'accept' %}" class="submit-btn">  Accept</a>
                <a href="{% url 'update_request_status' req.id 'decline' %}" class="submit-btn" style="background:#b22222;">❌ Decline</a>
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No one has requested your items yet.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
