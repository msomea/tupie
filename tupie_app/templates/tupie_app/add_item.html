{% extends 'tupie_app/base.html' %}
{% load static %}

{% block title %}List Item - Tupie{% endblock %}

{% block content %}
<section class="form-section">
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    <h2>List an Item</h2>
    <p>Fill in the details to give your item a new home</p>

    <form method="post" enctype="multipart/form-data" class="item-form" id="item-form">
        {% csrf_token %}
        {{ item_form.non_field_errors }}

        <h3>Item Details</h3>
        <p>
            {{ item_form.title.label_tag }}
            {{ item_form.title }}
            {{ item_form.title.errors }}
        </p>

        <p>
            {{ item_form.description.label_tag }}
            {{ item_form.description }}
            {{ item_form.description.errors }}
        </p>

        <p>
            {{ item_form.category.label_tag }}
            {{ item_form.category }}
            {{ item_form.category.errors }}
        </p>

        <p>
            <label for="id_region">Region</label>
            <select name="region" id="id_region" class="form-control">
                <option value="">-- Select Region --</option>
                {% for region in regions %}
                    <option value="{{ region.region_code }}" {% if form.region.value == region.region_code|stringformat:"s" %}selected{% endif %}>{{ region.region_name }}</option>
                {% endfor %}
            </select>
            {% if form.region.errors %}
                <span class="error">{{ form.region.errors }}</span>
            {% endif %}
        </p>

        <p>
            <label for="id_district">District</label>
            <select name="district" id="id_district" class="form-control">
                <option value="">-- Select District --</option>
                {% if form.district.value %}
                    <!-- Optionally populate with district name for edit forms -->
                    <option value="{{ form.district.value }}" selected>{{ form.district.value }}</option>
                {% endif %}
            </select>
            {% if form.district.errors %}
                <span class="error">{{ form.district.errors }}</span>
            {% endif %}
        </p>

        <p>
            <label for="id_ward">Ward</label>
            <select name="ward" id="id_ward" class="form-control">
                <option value="">-- Select Ward --</option>
                {% if form.ward.value %}
                    <option value="{{ form.ward.value }}" selected>{{ form.ward.value }}</option>
                {% endif %}
            </select>
            {% if form.ward.errors %}
                <span class="error">{{ form.ward.errors }}</span>
            {% endif %}
        </p>

        <p>
            <label for="id_place">Place</label>
            <select name="place" id="id_place" class="form-control">
                <option value="">-- Select Place --</option>
                {% if form.place.value %}
                    <option value="{{ form.place.value }}" selected>{{ form.place.value }}</option>
                {% endif %}
            </select>
            {% if form.place.errors %}
                <span class="error">{{ form.place.errors }}</span>
            {% endif %}
        </p>

        <p>
            {{ item_form.street.label_tag }}
            {{ item_form.street }}
            {{ item_form.street.errors }}
        </p>

        <h3>Add Images</h3>
        {{ formset.management_form }}
        {% for form in formset %}
            {{ form.as_p }}
        {% endfor %}

    <button type="submit" class="submit-btn">Add Item</button>
    </form>
</section>

<script src="{% static 'tupie_app/js/script.js' %}"></script>

{% endblock %}
